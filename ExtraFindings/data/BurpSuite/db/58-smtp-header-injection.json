{
    "id": 2099200,
    "title": "SMTP header injection",
    "description": [
        "SMTP header injection vulnerabilities arise when user input is placed into email headers without adequate sanitization, allowing an attacker to inject additional headers with arbitrary values. This behavior can be exploited to send copies of emails to third parties, attach viruses, deliver phishing attacks, and often alter the content of emails. It is typically exploited by spammers looking to leverage the vulnerable company's reputation to add legitimacy to their emails.",
        "This issue is particularly serious if the email contains sensitive information not intended for the attacker, such as a password reset token."
    ],
    "fix": {
        "effort": 0, 
        "guidance": [
            "Validate that user input conforms to a whitelist of safe characters before placing it into email headers. In particular, input containing newlines and carriage returns should be rejected. Alternatively, consider switching to an email library that automatically prevents such attacks."
        ]
    },
    "references": [
        {
            "url": "https://portswigger.net/kb/issues/00200800_smtp-header-injection",
            "title": "SMTP header injection"
        },
        {
            "url": "https://portswigger.net/blog/introducing-burp-collaborator",
            "title": "Introducing Burp Collaborator"
        },
        {
            "url": "https://cwe.mitre.org/data/definitions/93.html",
            "title": "CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')"
        },
        {
            "url": "https://cwe.mitre.org/data/definitions/159.html",
            "title": "CWE-159: Failure to Sanitize Special Element"
        }
    ],
    "severity": "Medium",
    "language": "English"
}